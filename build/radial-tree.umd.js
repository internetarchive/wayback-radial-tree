!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","d3","lodash"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).wb={},e.d3,e._)}(this,(function(e,t,n){"use strict";function r(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var c=r(t);class a{constructor(e){this.fields=e[0],this.getIndexByName=n.memoize(this.getIndexByName)}getIndexByName(e){return this.fields.indexOf(e)}getValueByName(e,t){return e[this.getIndexByName(t)]}}const o=c.arc().startAngle((e=>e.x0)).endAngle((e=>e.x1)).innerRadius((e=>Math.sqrt(e.y0))).outerRadius((e=>Math.sqrt(e.y1))),i=c.scaleOrdinal(c.schemePaired);function s(e,t,n,r,a,s){const l=c.partition().size([2*Math.PI,n*n])(c.hierarchy({children:[s]}).sum((e=>!e.children)).sort(((e,t)=>t.value-e.value))).descendants(),d=e.querySelector(".sequence");function u(e){let t=e.ancestors().reverse().slice(1).map((e=>e.data.name)).join("/");return`${r}/web/${a}0630/${t}`}function p(e,n){const r=n.ancestors().reverse();r.shift();const a=u(n);!function(e,t){const n=e.map((e=>e.data.name)).join("/");d.innerHTML=`<a href="${t}">${decodeURIComponent(n)}</a>`}(r,a),c.selectAll("path").style("opacity",.3),t.selectAll("path").filter((e=>r.indexOf(e)>=0)).style("opacity",1)}t.selectAll("path").data(l).enter().append("a").attr("xlink:href",u).on("touchstart",(function(e,t){return e.preventDefault(),e.stopPropagation(),p(),!1})).append("svg:path").attr("display",(e=>e.depth?null:"none")).attr("d",o).attr("fill-rule","evenodd").style("fill",(e=>i((e.children?e:e.parent).data.name))).style("opacity",1).style("cursor","pointer").on("mouseover",p),c.select("#d3_container").on("mouseleave",(function(){d.innerHTML="",c.selectAll("path").on("mouseover",null),c.selectAll("path").transition().style("opacity",1).on("end",(function(){c.select(this).on("mouseover",p)}))}))}function l(e,t,n){const r=e.querySelector(".div-btn");r.onclick=e=>n(e.target.id),e.querySelector(".year-btn")||t.forEach((e=>r.appendChild(function(e){const t=document.createElement("button");return t.className="year-btn",t.id=e,t.textContent=e,t}(e))))}e.RadialTree=function(e,t){const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).baseURL||"https://web.archive.org",r=function(){const e=document.createElement("div");e.setAttribute("class","rt-content");const t=document.createElement("div");t.setAttribute("class","div-btn");const n=document.createElement("p");n.setAttribute("class","sequence");const r=document.createElement("div");return r.setAttribute("id","chart"),e.appendChild(t),e.appendChild(n),e.appendChild(r),e.style.display="block",e}();e.appendChild(r);const o=new a(t),i=function(e){let{groupBy:t,dedupBy:n,orderBy:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return e;const c=new a(e),o=c.getIndexByName(t),i=c.getIndexByName(n),s=c.getIndexByName(r),l=e.slice(1).reduce(((e,t)=>{const n=t[o],r=t[i];return e[n]||(e[n]={}),e[n][r]||(e[n][r]=t),e}),{});return Object.keys(l).reduce(((e,t)=>{const n=Object.values(l[t]);return e[t]=n.sort(((e,t)=>e[s]-t[s])),e}),{})}(t,{groupBy:"timestamp:4",dedupBy:"urlkey",orderBy:"urlkey"}),d=(u=i)?Object.keys(u).sort():u;var u;function p(t){e.querySelector(".active-btn")&&e.querySelector(".active-btn").classList.remove("active-btn");const r=function(e,t){return e.ownerDocument.getElementById(t)}(e,t);r&&r.classList.add("active-btn"),function(e,t){e.querySelector(".sequence").innerHTML="",e.querySelector("#chart").innerHTML="";const r=e.querySelector("#chart").offsetWidth,a=r,l=r/2,d=c.select("#chart").append("svg:svg").attr("width",r).attr("height",a).append("svg:g").attr("id","d3_container").attr("transform","translate("+r/2+","+a/2+")");d.append("svg:circle").attr("r",l).style("opacity",0);const u=i[t],p=function(e,t,n){let{targetField:r}=n;return t.reduce(((t,n)=>{const[c,...a]=e.getValueByName(n,r).split("/");var o;return t.name=(o=c)?o.slice(0,o.length-1).split(",").reverse().join("."):o,function(e,t){if(!t||0===t.length)return;let n=e,r=t;for(;r.length>0;){const[e,...t]=r;if(!e)return;n.children||(n.children=[]);let c=n.children.find((t=>t.name===e));c||(c={name:e},n.children.push(c)),n=c,r=t}}(t,a),t}),{})}(o,u,{targetField:"urlkey"});s(e,d,l,n,t,p)}(e,t)}l(e,d,p),p(d[d.length-2]||d[0])}}));
//# sourceMappingURL=radial-tree.umd.js.map
