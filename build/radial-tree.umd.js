!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).wb={},e.d3)}(this,(function(e,t){"use strict";function n(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var r=n(t);class c{constructor(e){this.fields=e[0],this._indexCache=new Map}getIndexByName(e){if(this._indexCache.has(e))return this._indexCache.get(e);const t=this.fields.indexOf(e);return this._indexCache.set(e,t),t}getValueByName(e,t){return e[this.getIndexByName(t)]}}const a=r.arc().startAngle((e=>e.x0)).endAngle((e=>e.x1)).innerRadius((e=>Math.sqrt(e.y0))).outerRadius((e=>Math.sqrt(e.y1))),o=r.scaleOrdinal(r.schemePaired);function i(e,t,n,c,i,s){const l=r.partition().size([2*Math.PI,n*n])(r.hierarchy({children:[s]}).sum((e=>!e.children)).sort(((e,t)=>t.value-e.value))).descendants(),d=e.querySelector(".sequence");function u(e){let t=e.ancestors().reverse().slice(1).map((e=>e.data.name)).join("/");return"".concat(c,"/web/").concat(i,"0630/").concat(t)}function h(e,n){const c=n.ancestors().reverse();c.shift();const a=u(n);!function(e,t){const n=e.map((e=>e.data.name)).join("/");d.innerHTML='<a href="'.concat(t,'">').concat(decodeURIComponent(n),"</a>")}(c,a),r.selectAll("path").style("opacity",.3),t.selectAll("path").filter((e=>c.indexOf(e)>=0)).style("opacity",1)}t.selectAll("path").data(l).enter().append("a").attr("xlink:href",u).on("touchstart",(function(e,t){return e.preventDefault(),e.stopPropagation(),h(),!1})).append("svg:path").attr("display",(e=>e.depth?null:"none")).attr("d",a).attr("fill-rule","evenodd").style("fill",(e=>o((e.children?e:e.parent).data.name))).style("opacity",1).style("cursor","pointer").on("mouseover",h),r.select("#d3_container").on("mouseleave",(function(){d.innerHTML="",r.selectAll("path").on("mouseover",null),r.selectAll("path").transition().style("opacity",1).on("end",(function(){r.select(this).on("mouseover",h)}))}))}function s(e,t,n){const r=e.querySelector(".div-btn");r.onclick=e=>n(e.target.id),e.querySelector(".year-btn")||t.forEach((e=>r.appendChild(function(e){const t=document.createElement("button");return t.className="year-btn",t.id=e,t.textContent=e,t}(e))))}e.RadialTree=function(e,t){const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).baseURL||"https://web.archive.org",a=function(){const e=document.createElement("div");e.setAttribute("class","rt-content");const t=document.createElement("div");t.setAttribute("class","div-btn");const n=document.createElement("p");n.setAttribute("class","sequence");const r=document.createElement("div");return r.setAttribute("id","chart"),e.appendChild(t),e.appendChild(n),e.appendChild(r),e.style.display="block",e}();e.appendChild(a);const o=new c(t),l=function(e){let{groupBy:t,dedupBy:n,orderBy:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return e;const a=new c(e),o=a.getIndexByName(t),i=a.getIndexByName(n),s=a.getIndexByName(r),l=e.slice(1).reduce(((e,t)=>{const n=t[o],r=t[i];return e[n]||(e[n]={}),e[n][r]||(e[n][r]=t),e}),{});return Object.keys(l).reduce(((e,t)=>{const n=Object.values(l[t]);return e[t]=n.sort(((e,t)=>e[s]-t[s])),e}),{})}(t,{groupBy:"timestamp:4",dedupBy:"urlkey",orderBy:"urlkey"}),d=(u=l)?Object.keys(u).sort():u;var u;function h(t){e.querySelector(".active-btn")&&e.querySelector(".active-btn").classList.remove("active-btn");const c=function(e,t){return e.ownerDocument.getElementById(t)}(e,t);c&&c.classList.add("active-btn"),function(e,t){e.querySelector(".sequence").innerHTML="",e.querySelector("#chart").innerHTML="";const c=e.querySelector("#chart").offsetWidth,a=c,s=c/2,d=r.select("#chart").append("svg:svg").attr("width",c).attr("height",a).append("svg:g").attr("id","d3_container").attr("transform","translate("+c/2+","+a/2+")");d.append("svg:circle").attr("r",s).style("opacity",0);const u=l[t],h=function(e,t,n){let{targetField:r}=n;return t.reduce(((t,n)=>{const[c,...a]=e.getValueByName(n,r).split("/");var o;return t.name=(o=c)?o.slice(0,o.length-1).split(",").reverse().join("."):o,function(e,t){if(!t||0===t.length)return;let n=e,r=t;for(;r.length>0;){const[e,...t]=r;if(!e)return;n.children||(n.children=[]);let c=n.children.find((t=>t.name===e));c||(c={name:e},n.children.push(c)),n=c,r=t}}(t,a),t}),{})}(o,u,{targetField:"urlkey"});i(e,d,s,n,t,h)}(e,t)}s(e,d,h),h(d[d.length-2]||d[0])}}));
//# sourceMappingURL=radial-tree.umd.js.map
