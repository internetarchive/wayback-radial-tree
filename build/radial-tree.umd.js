!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","d3","lodash"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).wb={},e.d3,e._)}(this,(function(e,t,n){"use strict";function r(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var a=r(t);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,i=void 0,"symbol"==typeof(i=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"))?i:String(i)),r)}var a,i}function o(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){if(t&&0!==t.length){var n,r=o(t),a=r[0],i=r.slice(1);if(a)e.children?n=e.children.filter((function(e){return e.name===a}))[0]:e.children=[],n||(n={name:a},e.children.push(n)),c(n,i)}}function l(e,t,n){var r=n.targetField;return t.reduce((function(t,n){var a,i=o(e.getValueByName(n,r).split("/")),u=i[0],l=i.slice(1);return t.name=(a=u)?(a=a.slice(0,a.length-1)).split(",").reverse().join("."):a,c(t,l),t}),{})}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fields=t[0],this.getIndexByName=n.memoize(this.getIndexByName)}var t,r,a;return t=e,(r=[{key:"getIndexByName",value:function(e){return this.fields.indexOf(e)}},{key:"getValueByName",value:function(e,t){return e[this.getIndexByName(t)]}}])&&i(t.prototype,r),a&&i(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();var d=a.arc().startAngle((function(e){return e.x0})).endAngle((function(e){return e.x1})).innerRadius((function(e){return Math.sqrt(e.y0)})).outerRadius((function(e){return Math.sqrt(e.y1)})),f=a.scaleOrdinal(a.schemePaired);function y(e,t,n,r,i,o){var u=a.partition().size([2*Math.PI,n*n])(a.hierarchy({children:[o]}).sum((function(e){return!e.children})).sort((function(e,t){return t.value-e.value}))).descendants();function c(e){for(var t=e.ancestors().reverse(),n="",a=1;a<t.length&&"end"!==t[a].data.name;a++)n=n+"/"+t[a].data.name;return"".concat(r,"/web/").concat(i,"0630").concat(n)}function l(n,r){var i=r.ancestors().reverse();i.shift();var o=c(r);!function(t,n){var r="",a=document.createElement("span");a.setAttribute("class","symb"),a.innerHTML="/";for(var i=0;i<t.length;i++)r=0===i?" "+t[i].data.name:r+a.innerHTML+t[i].data.name;r=decodeURIComponent(r),e.querySelector(".sequence").innerHTML='<a href="'.concat(n,'">').concat(r,"</a>")}(i,o),a.selectAll("path").style("opacity",.3),t.selectAll("path").filter((function(e){return i.indexOf(e)>=0})).style("opacity",1)}t.selectAll("path").data(u).enter().append("a").attr("xlink:href",c).on("touchstart",(function(e,t){return e.preventDefault(),e.stopPropagation(),l(),!1})).append("svg:path").attr("display",(function(e){return e.depth?null:"none"})).attr("d",d).attr("fill-rule","evenodd").style("fill",(function(e){return f((e.children?e:e.parent).data.name)})).style("opacity",1).style("cursor","pointer").on("mouseover",l),a.select("#d3_container").on("mouseleave",(function(){e.querySelector(".sequence").innerHTML="",a.selectAll("path").on("mouseover",null),a.selectAll("path").transition().style("opacity",1).on("end",(function(){a.select(this).on("mouseover",l)}))}))}function p(e,t,n){var r=e.querySelector(".div-btn");r.onclick=function(e){return n(e.target.id)},e.querySelector(".year-btn")||t.forEach((function(e){return r.appendChild(function(e){var t=document.createElement("button");return t.setAttribute("class","year-btn"),t.setAttribute("id",e),t.innerHTML=e,t}(e))}))}e.RadialTree=function(e,t){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).baseURL||"https://web.archive.org",i=function(){var e=document.createElement("div");e.setAttribute("class","rt-content");var t=document.createElement("div");t.setAttribute("class","div-btn");var n=document.createElement("p");n.setAttribute("class","sequence");var r=document.createElement("div");return r.setAttribute("id","chart"),e.appendChild(t),e.appendChild(n),e.appendChild(r),e.style.display="block",e}();e.appendChild(i);var o,u=new s(t),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.groupBy,a=t.dedupBy,i=t.orderBy;if(!e)return e;var o=new s(e),u=e.slice(1).reduce((function(e,t){var n=e[o.getValueByName(t,r)]||{};return n[o.getValueByName(t,a)]||(n[o.getValueByName(t,a)]=t),e[o.getValueByName(t,r)]=n,e}),{});return n(u).mapValues((function(e){return Object.values(e)})).mapValues((function(e){return n.sortBy(e,o.getIndexByName(i))})).value()}(t,{groupBy:"timestamp:4",dedupBy:"urlkey",orderBy:"urlkey"}),d=(o=c)?Object.keys(o).sort():o;function f(t){e.querySelector(".active-btn")&&e.querySelector(".active-btn").classList.remove("active-btn");var n=function(e,t){return e.ownerDocument.getElementById(t)}(e,t);n&&n.classList.add("active-btn"),function(e,t){e.querySelector(".sequence").innerHTML="",e.querySelector("#chart").innerHTML="";var n=e.querySelector("#chart").offsetWidth,i=n,o=Math.min(n,i)/2,s=a.select("#chart").append("svg:svg").attr("width",n).attr("height",i).append("svg:g").attr("id","d3_container").attr("transform","translate("+n/2+","+i/2+")");s.append("svg:circle").attr("r",o).style("opacity",0);var d=c[t],f=l(u,d,{targetField:"urlkey"});y(e,s,o,r,t,f)}(e,t)}p(e,d,f),f(d[d.length-2]||d[0])}}));
//# sourceMappingURL=radial-tree.umd.js.map
